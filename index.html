<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Zona Gematria</title>
  <style>
    * { box-sizing: border-box; font-family: Arial, Helvetica, sans-serif; }
    body { background:#f0f2f5; margin:0; }
    header { background:#1877f2; color:#fff; padding:15px; text-align:center; font-size:22px; font-weight:bold; }
    .container { max-width:600px; margin:20px auto; }
    .box, .post { background:#fff; padding:15px; border-radius:8px; margin-bottom:15px; }
    input, textarea { width:100%; padding:8px; margin-top:8px; }
    textarea { resize:none; height:70px; }
    button { background:#1877f2; color:#fff; border:none; padding:8px 12px; border-radius:5px; cursor:pointer; }
    button:hover { background:#145dbf; }
    .actions { margin-top:10px; display:flex; gap:10px; }
    .comment { background:#f0f2f5; padding:5px; border-radius:5px; margin-top:5px; font-size:13px; }
    .user { font-weight:bold; margin-bottom:5px; }
  </style>
</head>
<body>

<header>Zona Gematria</header>

<div class="container">

  <div class="box">
    <input id="username" placeholder="Seu nome">
    <textarea id="postText" placeholder="No que vocÃª estÃ¡ pensando?"></textarea>
    <button onclick="addPost()">Publicar</button>
  </div>

  <div id="feed"></div>

</div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
  import {
    getFirestore, collection, addDoc, doc, updateDoc,
    onSnapshot, serverTimestamp, query, orderBy
  } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

  // ðŸ”´ COLE AQUI SUAS CHAVES DO FIREBASE
  const firebaseConfig = {
    apiKey: "SUA_API_KEY",
    authDomain: "SEU_DOMINIO",
    projectId: "SEU_PROJECT_ID",
    storageBucket: "SEU_BUCKET",
    messagingSenderId: "SEU_ID",
    appId: "SEU_APP_ID"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  const feed = document.getElementById("feed");

  window.addPost = async () => {
    const text = postText.value.trim();
    const user = username.value.trim() || "AnÃ´nimo";
    if (!text) return;

    await addDoc(collection(db, "posts"), {
      user,
      text,
      likes: 0,
      comments: [],
      createdAt: serverTimestamp()
    });

    postText.value = "";
  };

  window.likePost = async (id, likes) => {
    await updateDoc(doc(db, "posts", id), { likes: likes + 1 });
  };

  window.addComment = async (id, comments, input) => {
    if (!input.value.trim()) return;
    comments.push(input.value);
    input.value = "";
    await updateDoc(doc(db, "posts", id), { comments });
  };

  const q = query(collection(db, "posts"), orderBy("createdAt", "desc"));

  onSnapshot(q, (snapshot) => {
    feed.innerHTML = "";
    snapshot.forEach(d => {
      const p = d.data();
      const div = document.createElement("div");
      div.className = "post";

      div.innerHTML = `
        <div class="user">${p.user}</div>
        <p>${p.text}</p>
        <div class="actions">
          <button onclick="likePost('${d.id}', ${p.likes})">Curtir (${p.likes})</button>
        </div>
        <input placeholder="Comentar..." 
          onkeydown="if(event.key==='Enter') addComment('${d.id}', ${JSON.stringify(p.comments)}, this)">
        ${p.comments.map(c => `<div class="comment">${c}</div>`).join("")}
      `;

      feed.appendChild(div);
    });
  });
</script>

</body>
</html>
